webpackJsonp([1],{NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("7+uW"),n=s("C/JF"),i=s("fhbW"),o=s("1e6/"),r=s("Dd8w"),m=s.n(r),c=s("NYxO"),d=s("e7x4"),u=s.n(d),l=s("bOdI"),f=s.n(l),g=s("gRE1"),p=s.n(g);window.firebase.initializeApp({apiKey:"AIzaSyDeQSrnOySw3Ws-PT1Isq_8-FeIS2B-PZw",authDomain:"vue-chat-room-11def.firebaseapp.com",databaseURL:"https://vue-chat-room-11def.firebaseio.com",projectId:"vue-chat-room-11def",storageBucket:"vue-chat-room-11def.appspot.com",messagingSenderId:"249927196895"});var v=window.firebase.database(),h=function(e){return v.ref(e)},_={name:"Messages",data:function(){return{messages:{}}},computed:m()({messagesList:function(){return p()(this.messages).filter(function(e){return e})}},Object(c.d)({messageIdForEditMode:function(e){return e.messageForm.id},name:function(e){return e.auth.name}})),methods:m()({},Object(c.c)("messageForm",["updateFormData","resetFormData"]),{deleteMessage:function(e){var t=e.id;h("messages").child(t).remove()},openEditMessageMode:function(e){var t=e.id;this.updateFormData({text:this.messages[t].text,id:t}),document.getElementById("message-form-input").focus()},cancelEditMessageMode:function(){this.resetFormData()}}),created:function(){var e=this;h("messages").on("child_added",function(t){e.messages=m()({},e.messages,f()({},t.key,m()({},t.val(),{id:t.key}))),setTimeout(function(){var e=document.getElementById("messages");e.scrollTop=e.scrollHeight},100)}),h("messages").on("child_changed",function(t){e.messages=m()({},e.messages,f()({},t.key,m()({},t.val(),{id:t.key})))}),h("messages").on("child_removed",function(t){e.messages=m()({},e.messages,f()({},t.key,null))})}},x={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"messages",attrs:{id:"messages"}},[e.messagesList.length&&e.name?e._l(e.messagesList,function(t){return s("div",{key:t.timestamp,staticClass:"message",class:{isReply:t.name!==e.name,isSender:t.name===e.name}},[s("div",{staticClass:"message__content"},[t.name!==e.name?s("span",{staticClass:"message__icon"},[e._v(e._s(t.name.charAt(0)))]):e._e(),e._v(" "),s("div",{staticClass:"message__text",class:{edit:t.id===e.messageIdForEditMode}},[s("span",[e._v("\n          "+e._s(t.text.trim())+"\n        ")]),e._v(" "),t.name===e.name?s("div",{staticClass:"message__text-icons"},[t.id!==e.messageIdForEditMode?s("div",[s("font-awesome-icon",{staticClass:"message__text-icon",attrs:{icon:"edit"},on:{click:function(s){return s.preventDefault(),e.openEditMessageMode({id:t.id})}}}),e._v(" "),s("font-awesome-icon",{staticClass:"message__text-icon",attrs:{icon:"times-circle"},on:{click:function(s){return s.preventDefault(),e.deleteMessage({id:t.id})}}})],1):s("div",[s("font-awesome-icon",{staticClass:"message__text-icon",attrs:{icon:"undo"},on:{click:function(s){return s.preventDefault(),e.cancelEditMessageMode({id:t.id})}}})],1)]):e._e()])])])}):s("div",{staticClass:"messages__loader d-flex justify-content-center"},[e._m(0)])],2)},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"spinner-border",attrs:{role:"status"}},[t("span",{staticClass:"sr-only"},[this._v("Loading...")])])}]};var w=s("VU/8")(_,x,!1,function(e){s("joP4")},"data-v-53eedfa7",null).exports,F={name:"NewMessage",computed:m()({},Object(c.d)({id:function(e){return e.messageForm.id},name:function(e){return e.auth.name}}),{text:{get:function(){return this.$store.state.messageForm.text},set:function(e){this.updateFormData({text:e,id:this.id})}}}),methods:m()({},Object(c.c)("messageForm",["updateFormData","resetFormData"]),{saveNewMessage:function(){var e=this;h("messages").push({name:this.name,text:this.text,timestamp:Date.now()},function(t){if(t)throw new Error("Can not send the message");e.resetFormData()})},updateMessage:function(){var e=this;h("messages").child(this.id).update({text:this.text,updatedAt:Date.now()},function(t){if(t)throw new Error("Can not update the message");e.resetFormData()})},handleInputKeypress:function(e){"Enter"===e.key&&this.handleFormSubmit()},handleFormSubmit:function(){this.id?this.updateMessage():this.saveNewMessage()}})},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"new-message"},[s("form",{on:{submit:function(t){return t.preventDefault(),e.handleFormSubmit(t)}}},[s("div",{staticClass:"form-group"},[s("textarea",{directives:[{name:"model",rawName:"v-model",value:e.text,expression:"text"}],staticClass:"form-control",attrs:{id:"message-form-input",placeholder:"Your message",rows:"3"},domProps:{value:e.text},on:{keypress:e.handleInputKeypress,input:function(t){t.target.composing||(e.text=t.target.value)}}})]),e._v(" "),s("button",{staticClass:"btn btn-primary",attrs:{type:"submit"}},[e._v(e._s(e.id?"Update":"Send New")+" Message")])])])},staticRenderFns:[]};var y={name:"App",components:{Messages:w,NewMessage:s("VU/8")(F,b,!1,function(e){s("u4kV")},"data-v-aa169fc4",null).exports},methods:m()({},Object(c.b)("auth",["auth","setName"])),created:function(){var e=this;localStorage.getItem("slaym-chat-name")||u.a.fire({title:"Please provide your name",input:"text",inputValue:"",inputValidator:function(e){return!e&&"Please use some name"}}).then(function(t){e.setName(t.value)})}},M={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("div",{staticClass:"main-icon"}),this._v(" "),t("Messages"),this._v(" "),t("NewMessage")],1)},staticRenderFns:[]};var C=s("VU/8")(y,M,!1,function(e){s("ngLW")},null,null).exports;a.a.use(c.a);var D={namespaced:!0,state:{name:localStorage.getItem("slaym-chat-name")},mutations:{setName:function(e,t){e.name=t}},actions:{setName:function(e,t){localStorage.setItem("slaym-chat-name",t),e.commit("setName",t)}}};a.a.use(c.a);var E={namespaced:!0,state:{text:"",id:void 0},mutations:{updateFormData:function(e,t){var s=t.text,a=t.id;e.text=s,e.id=a},resetFormData:function(e){e.text="",e.id=""}}};a.a.use(c.a);var I=new c.a.Store({modules:{auth:D,messageForm:E}});n.c.add(i.a),n.c.add(i.c),n.c.add(i.d),n.c.add(i.b),a.a.component("font-awesome-icon",o.a),a.a.config.productionTip=!1,new a.a({el:"#app",components:{App:C},template:"<App/>",store:I})},joP4:function(e,t){},ngLW:function(e,t){},u4kV:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.99e8ceca42db4e52866c.js.map